"use strict";(self.webpackChunkkubernetes_dashboard=self.webpackChunkkubernetes_dashboard||[]).push([[986],{6986:(Dn,W,m)=>{m.r(W),m.d(W,{CreateModule:()=>yn});var H=m(1028),J=m(5861),Q=m(6911),x=m(833),X=m(3778),$=m(488),e=m(4650),N=m(529),k=m(8177),u=m(5938),P=m(4793);let v=(()=>{class n{constructor(t,r,a,_,s,c){this.http_=t,this.namespace_=r,this.csrfToken_=a,this.matDialog_=_,this.router_=s,this.CONFIG=c,this.isDeployInProgress_=!1}createContent(t,r=!0,a=""){var _=this;return(0,J.Z)(function*(){const s={name:a,namespace:_.namespace_.current(),content:t,validate:r};let c,d;try{const{token:p}=yield _.csrfToken_.getTokenForAction("appdeploymentfromfile").toPromise();_.isDeployInProgress_=!0,c=yield _.http_.post("api/v1/appdeploymentfromfile",s,{headers:{[_.CONFIG.csrfHeaderName]:p}}).toPromise(),c.error.length>0&&_.reportError_("Deployment has been partly completed",c.error)}catch(p){d=p}if(_.isDeployInProgress_=!1,d)throw _.reportError_("Deploying file has failed",(0,Q.Vf)(d).message),d;return c})()}deploy(t){var r=this;return(0,J.Z)(function*(){let a,_;try{const{token:s}=yield r.csrfToken_.getTokenForAction("appdeployment").toPromise();r.isDeployInProgress_=!0,a=yield r.http_.post("api/v1/appdeployment",t,{headers:{[r.CONFIG.csrfHeaderName]:s}}).toPromise()}catch(s){_=s}if(r.isDeployInProgress_=!1,_)throw r.reportError_("Deploying file has failed",(0,Q.Vf)(_).message),_;return a})()}isDeployDisabled(){return this.isDeployInProgress_}reportError_(t,r){this.matDialog_.open(X.a,{data:{title:t,message:r,confirmLabel:"OK"}})}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275inject(N.eN),e.\u0275\u0275inject($.L),e.\u0275\u0275inject(k.Q),e.\u0275\u0275inject(u.uw),e.\u0275\u0275inject(P.Router),e.\u0275\u0275inject(x.ED))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n})(),tt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({providers:[v]}),n})();var F=m(4859);let nt=(()=>{class n{constructor(t){this.data=t}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(u.WI))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-confirm-dialog"]],decls:9,vars:4,consts:[["mat-dialog-title",""],[1,"kd-dialog-text"],["mat-button","","color","secondary",3,"mat-dialog-close"],["mat-button","","color","primary",3,"mat-dialog-close"]],template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"h2",0),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-dialog-content",1),e.\u0275\u0275text(3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-dialog-actions")(5,"button",2),e.\u0275\u0275text(6,"No"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",3),e.\u0275\u0275text(8,"Yes"),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(r.data.title),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(r.data.message),e.\u0275\u0275advance(2),e.\u0275\u0275property("mat-dialog-close",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("mat-dialog-close",!0))},directives:[u.uh,u.xY,u.H8,F.lW,u.ZT],encapsulation:2}),n})();var y=m(9646);let Z=(()=>{class n{constructor(t){this.dialog_=t}canDeactivate(t){return t.canDeactivate()?(0,y.of)(!0):this.dialog_.open(nt,{data:{title:"Unsaved changes",message:"The form has not been submitted yet, do you really want to leave?"}}).afterClosed()}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275inject(u.uw))},n.\u0275prov=e.\u0275\u0275defineInjectable({token:n,factory:n.\u0275fac}),n})();var ee=m(6042),C=m(6895);let rt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[C.CommonModule,ee.m,H.K]]}),n})();var ot=m(3456);let D=(()=>{class n{unloadNotification(t){this.canDeactivate()||(t.returnValue=!0)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=e.\u0275\u0275defineDirective({type:n,hostBindings:function(t,r){1&t&&e.\u0275\u0275listener("beforeunload",function(_){return r.unloadNotification(_)},!1,e.\u0275\u0275resolveWindow)}}),n})();var i=m(4006),w=m(5908),z=m(9335),at=m(1230);function it(n,o){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,10),e.\u0275\u0275elementEnd())}function _t(n,o){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,11),e.\u0275\u0275elementEnd())}let te=(()=>{class n extends D{constructor(t,r,a,_){super(),this.namespace_=t,this.create_=r,this.history_=a,this.router_=_,this.created_=!1}isCreateDisabled(){return!this.file||0===this.file.content.length}create(){this.create_.createContent(this.file.content,!0,this.file.name).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[w.x]:this.namespace_.current()}})})}onFileLoad(t){this.file=t}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}canDeactivate(){return this.isCreateDisabled()||this.created_}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject($.L),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(z.q),e.\u0275\u0275directiveInject(P.Router))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create-from-file"]],viewQuery:function(t,r){if(1&t&&e.\u0275\u0275viewQuery(i.NgForm,7),2&t){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.ngForm=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:11,vars:3,consts:function(){let o,t,r,a,_,s;return o=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#5\ufffd" + "open_in_new" + "\ufffd/#5\ufffd" + "",t="\u9009\u62E9 YAML \u6216 JSON \u6587\u4EF6",r="Upload\n",a="Cancel\n",_=" \u9009\u62E9 YAML \u6216 JSON \u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u8D44\u6E90\u90E8\u7F72\u5230\u8BE5\u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4\u3002",s=" \u9009\u62E9 YAML \u6216 JSON \u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u8D44\u6E90\u90E8\u7F72\u5230\u5F53\u524D\u9009\u5B9A\u7684\u547D\u540D\u7A7A\u95F4\u3002",[[1,"kd-create-from-file-info"],[4,"ngIf"],["href","https://kubernetes.io/docs/tasks/run-application/run-stateless-application-deployment/","target","_blank"],o,[1,"material-icons"],["label",t,3,"onLoad"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],r,["type","button","color","primary","mat-button","",3,"click"],a,_,s]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,it,2,0,"span",1),e.\u0275\u0275template(2,_t,2,0,"span",1),e.\u0275\u0275elementStart(3,"a",2),e.\u0275\u0275i18nStart(4,3),e.\u0275\u0275element(5,"i",4),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"kd-upload-file",5),e.\u0275\u0275listener("onLoad",function(_){return r.onFileLoad(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",6),e.\u0275\u0275listener("click",function(){return r.create()}),e.\u0275\u0275i18n(8,7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",8),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275i18n(10,9),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.areMultipleNamespacesSelected()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.areMultipleNamespacesSelected()),e.\u0275\u0275advance(5),e.\u0275\u0275property("disabled",r.isCreateDisabled()))},directives:[C.NgIf,at.R,F.lW],styles:[".kd-create-from-file-info[_ngcontent-%COMP%]{margin-bottom:24px;padding:0 4px}.kd-create-from-file-info[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.kd-deploy-from-file-button[_ngcontent-%COMP%]{margin-left:0}"]}),n})();var ne=m(6906),I=m(5671),re=m(6758),oe=m(2722),ae=m(811);const lt=["group"];let st=(()=>{class n{constructor(t,r){this.dialogRef=t,this.data=r,this.text="",this.selectedMode=I.j.YAML,this.modes=I.j,this.unsubscribe_=new re.x}ngOnInit(){const t=this.toDeploymentConfiguration(this.data.spec);this.text=JSON.stringify(this.removeEmptyField(t)),this.buttonToggleGroup.valueChange.pipe((0,oe.R)(this.unsubscribe_)).subscribe(r=>{this.selectedMode=r,this.text&&this.updateText()})}ngOnDestroy(){this.unsubscribe_.next(),this.unsubscribe_.complete()}getSelectedMode(){return this.buttonToggleGroup.value}updateText(){this.text=this.selectedMode===I.j.YAML?(0,ne.$w)(JSON.parse(this.text)):this.toRawJSON((0,ne.zD)(this.text))}removeEmptyField(t){return JSON.parse(JSON.stringify(t),(r,a)=>{if(!(null==a||"object"==typeof a&&0===Object.entries(a).length||Array.isArray(a)&&(0===a.length||a.every(_=>null===_))))return a})}toDeploymentConfiguration(t){const r=Object.fromEntries(t.labels.map(a=>[a.key,a.value]));return{apiVersion:"apps/v1",kind:"Deployment",metadata:{name:t.name,namespace:t.namespace,labels:r},annotations:{description:t.description},spec:{replicas:t.replicas,selector:{matchLabels:r},template:{metadata:{name:t.name,labels:r},annotations:{description:t.description},spec:{containers:[{name:t.name,image:t.containerImage,command:[t.containerCommand],args:[t.containerCommandArgs],env:t.variables,resources:{requests:{cpu:t.cpuRequirement,memory:t.memoryRequirement}},securityContext:{privileged:t.runAsPrivileged}}],imagePullSecrets:[{name:t.imagePullSecret}]}}}}}toRawJSON(t){return JSON.stringify(t,null,"\t")}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(u.so),e.\u0275\u0275directiveInject(u.WI))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-preview-deploy-dialog"]],viewQuery:function(t,r){if(1&t&&e.\u0275\u0275viewQuery(lt,7),2&t){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.buttonToggleGroup=a.first)}},decls:13,vars:7,consts:function(){let o,t;return o="Preview Deployment",t="\u5173\u95ED",[["mat-dialog-title",""],o,[1,"kd-dialog-text"],["group","matButtonToggleGroup"],[3,"value","checked"],[3,"value"],[3,"text","readOnly","mode","textChange"],["mat-button","","color","primary",3,"mat-dialog-close"],t]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"h2",0),e.\u0275\u0275i18n(1,1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-dialog-content",2)(3,"mat-button-toggle-group",null,3)(5,"mat-button-toggle",4),e.\u0275\u0275text(6,"YAML"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"mat-button-toggle",5),e.\u0275\u0275text(8,"JSON"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(9,"kd-text-input",6),e.\u0275\u0275listener("textChange",function(_){return r.text=_}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"mat-dialog-actions")(11,"button",7),e.\u0275\u0275i18n(12,8),e.\u0275\u0275elementEnd()()),2&t&&(e.\u0275\u0275advance(5),e.\u0275\u0275property("value",r.modes.YAML)("checked",!0),e.\u0275\u0275advance(2),e.\u0275\u0275property("value",r.modes.JSON),e.\u0275\u0275advance(2),e.\u0275\u0275property("text",r.text)("readOnly",!0)("mode",r.getSelectedMode()),e.\u0275\u0275advance(2),e.\u0275\u0275property("mat-dialog-close",!1))},directives:[u.uh,u.xY,ae.A9,ae.Yi,I.t,u.H8,F.lW,u.ZT],encapsulation:2}),n})();var L=m(5698),ie=m(3900),O=m(1576);const mt=["*"];let q=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-help-section"]],ngContentSelectors:mt,decls:2,vars:0,consts:[["fxLayout","row","fxLayout.xs","column","fxLayout.sm","column",1,"kd-help-section"]],template:function(t,r){1&t&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd())},directives:[O.xw],styles:[".kd-help-section[_ngcontent-%COMP%]    >*{flex:1;flex-basis:auto;margin:8px 0;width:100%}.kd-help-section[_ngcontent-%COMP%]    >*:last-child{padding-left:32px}.kd-help-section[_ngcontent-%COMP%]    >*:first-child{max-width:48.5%}@media (max-width: 959px){.kd-help-section[_ngcontent-%COMP%]    >*:first-child{max-width:100%}}.kd-help-section[_ngcontent-%COMP%]   kd-port-mappings[_ngcontent-%COMP%]{margin-bottom:0;margin-top:0}"]}),n})();var g=m(9549),h=m(284);const ct=["*"];let Y=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-user-help"]],ngContentSelectors:ct,decls:2,vars:0,consts:[[1,"kd-user-help"]],template:function(t,r){1&t&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd())},styles:[".kd-user-help[_ngcontent-%COMP%]    {font-size:14px}.kd-user-help[_ngcontent-%COMP%]     .material-icons{font-size:12px;vertical-align:middle}"]}),n})();function dt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,16),e.\u0275\u0275elementEnd())}function Et(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,17),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(t.namespaceMaxLength),e.\u0275\u0275i18nApply(1)}}function ut(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,18),e.\u0275\u0275elementEnd())}let pt=(()=>{class n{constructor(t,r,a,_,s,c,d){this.dialogRef=t,this.data=r,this.http_=a,this.csrfToken_=_,this.matDialog_=s,this.fb_=c,this.appConfig_=d,this.namespaceMaxLength=63,this.namespacePattern=new RegExp("^[a-z0-9]([-a-z0-9]*[a-z0-9])?$")}ngOnInit(){this.form=this.fb_.group({namespace:["",i.Validators.compose([i.Validators.maxLength(this.namespaceMaxLength),i.Validators.pattern(this.namespacePattern)])]})}get namespace(){return this.form.get("namespace")}createNamespace(){if(!this.form.valid)return;const t={name:this.namespace.value};this.csrfToken_.getTokenForAction("namespace").pipe((0,ie.w)(a=>this.http_.post("api/v1/namespace",{...t},{headers:(new N.WM).set(this.appConfig_.csrfHeaderName,a.token)}))).subscribe(()=>{this.dialogRef.close(this.namespace.value)},a=>{this.dialogRef.close(),this.matDialog_.open(X.a,{data:{title:"Error creating namespace",message:a.data,confirmLabel:"OK"}})})}isDisabled(){return this.data.namespaces.indexOf(this.namespace.value)>=0}cancel(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(u.so),e.\u0275\u0275directiveInject(u.WI),e.\u0275\u0275directiveInject(N.eN),e.\u0275\u0275directiveInject(k.Q),e.\u0275\u0275directiveInject(u.uw),e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(x.ED))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create-namespace-dialog"]],decls:28,vars:7,consts:function(){let o,t,r,a,_,s,c,d,p,R;return o="Create a new namespace",t="\u65B0\u7684\u547D\u540D\u7A7A\u95F4\u5C06\u6DFB\u52A0\u5230\u96C6\u7FA4\u4E2D\u3002",r="\u547D\u540D\u7A7A\u95F4\u7684\u540D\u79F0",a="\u5C06\u5177\u6709\u6307\u5B9A\u540D\u79F0\u7684\u547D\u540D\u7A7A\u95F4\u6DFB\u52A0\u5230\u96C6\u7FA4\u4E2D\u3002",_=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#21\ufffd" + "open_in_new" + "\ufffd/#21\ufffd" + "",s=" Create ",c="Cancel",d=" \u540D\u79F0\u662F\u5FC5\u586B\u7684\u3002 ",p=" \u540D\u79F0\u5FC5\u987B\u5927\u4E8E " + "\ufffd0\ufffd" + " \u4E2A\u5B57\u7B26\u3002",R=" \u540D\u79F0\u5FC5\u987B\u662F\u5B57\u6BCD\u6216\u8005\u6570\u5B57\uFF0C\u53EF\u4EE5\u5305\u542B\u77ED\u5212\u7EBF\u3002",[["mat-dialog-title",""],o,[1,"kd-dialog-text"],t,[3,"formGroup"],["matInput","","type","text","placeholder",r,"name","namespace","formControlName","namespace","required",""],["align","end"],[4,"ngIf"],a,["href","https://kubernetes.io/docs/admin/namespaces/","target","_blank","tabindex","-1"],_,[1,"material-icons"],["mat-button","","type","submit","color","primary",3,"disabled","click"],s,["mat-button","",3,"click"],c,d,p,R]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"h4",0),e.\u0275\u0275i18n(1,1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-dialog-content",2),e.\u0275\u0275elementContainerStart(3),e.\u0275\u0275elementStart(4,"div"),e.\u0275\u0275i18n(5,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div")(7,"form",4)(8,"kd-help-section")(9,"mat-form-field"),e.\u0275\u0275element(10,"input",5),e.\u0275\u0275elementStart(11,"mat-hint",6),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,dt,2,0,"mat-error",7),e.\u0275\u0275template(14,Et,2,1,"mat-error",7),e.\u0275\u0275template(15,ut,2,0,"mat-error",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"kd-user-help"),e.\u0275\u0275elementContainerStart(17),e.\u0275\u0275i18n(18,8),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(19,"a",9),e.\u0275\u0275i18nStart(20,10),e.\u0275\u0275element(21,"i",11),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(22,"mat-dialog-actions",6),e.\u0275\u0275elementContainerStart(23),e.\u0275\u0275elementStart(24,"button",12),e.\u0275\u0275listener("click",function(){return r.createNamespace()}),e.\u0275\u0275i18n(25,13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(26,"button",14),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275i18n(27,15),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("formGroup",r.form),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate2("",r.namespace.value.length," / ",r.namespaceMaxLength,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.namespace.errors?null:r.namespace.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.namespace.errors?null:r.namespace.errors.maxlength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.namespace.errors?null:r.namespace.errors.pattern),e.\u0275\u0275advance(9),e.\u0275\u0275property("disabled",r.isDisabled()))},directives:[u.uh,u.xY,i.\u0275NgNoValidate,i.NgControlStatusGroup,i.FormGroupDirective,q,g.KE,h.Nt,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,i.RequiredValidator,g.bx,C.NgIf,g.TO,Y,u.H8,F.lW],encapsulation:2}),n})();class _e{constructor(o="",t="",r=!0){this.editable=r,this.key=o,this.value=t}}var j=m(8372),b=m(4004);let Tt=(()=>{class n{constructor(t){this.http=t}validate(t){return le(this.http,this.namespace)(t)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(N.eN))},n.\u0275dir=e.\u0275\u0275defineDirective({type:n,selectors:[["","kdUniqueName",""]],inputs:{namespace:"namespace"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_ASYNC_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])]}),n})();function le(n,o){return t=>t.value?n.post("api/v1/appdeployment/validate/name",{name:t.value,namespace:o}).pipe((0,j.b)(500),(0,b.U)(r=>r.valid?null:{uniqueName:t.value})):(0,y.of)(null)}class M{static namePattern(o){return o.value?new RegExp("^[a-z]([-a-z0-9]*[a-z0-9])?$").test(o.value)?null:{namePattern:{value:o.value}}:null}static isInteger(o){const t=o.value;return t?Number(t)===t&&t%1==0||!t?null:{kdValidInteger:{value:o.value}}:null}static labelKeyNameLength(o){const t=o.value,a=t.indexOf("/");return(a>-1?t.substring(a+1):t).length<=63?null:{kdValidLabelKeyPrefixLength:{value:!0}}}static labelKeyPrefixLength(o){const t=o.value,a=t.indexOf("/");return(a>-1?t.substring(0,a):"").length<=253?null:{kdValidLabelKeyPrefixLength:{value:!0}}}static labelKeyNamePattern(o){const t=o.value,a=t.indexOf("/"),_=a>-1?t.substring(a+1):t;return/^([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9]$/.test(_)||""===t?null:{kdValidLabelKeyNamePattern:{value:!0}}}static labelKeyPrefixPattern(o){const t=o.value,a=t.indexOf("/");return a>-1&&!/^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$/.test(t.substring(0,a))?{kdValidLabelKeyPrefixPattern:{value:!0}}:null}static labelValuePattern(o){return/^(([A-Za-z0-9][-A-Za-z0-9_.]*)?[A-Za-z0-9])?$/.test(o.value)?null:{kdValidLabelValuePattern:{value:!0}}}}function gt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,20),e.\u0275\u0275elementEnd())}function Ct(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,21),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(t.secretNameMaxLength),e.\u0275\u0275i18nApply(1)}}function Mt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,22),e.\u0275\u0275elementEnd())}function Nt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,23),e.\u0275\u0275elementEnd())}function Ft(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,24),e.\u0275\u0275elementEnd())}let Ot=(()=>{class n{constructor(t,r,a,_,s,c,d){this.dialogRef=t,this.data_=r,this.http_=a,this.csrfToken_=_,this.matDialog_=s,this.fb_=c,this.appConfig_=d,this.secretNameMaxLength=253,this.secretNamePattern=new RegExp("^[a-z0-9]([-a-z0-9]*[a-z0-9])?(\\.[a-z0-9]([-a-z0-9]*[a-z0-9])?)*$"),this.dataPattern=new RegExp("^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$")}ngOnInit(){this.form=this.fb_.group({secretName:["",i.Validators.compose([i.Validators.maxLength(this.secretNameMaxLength),i.Validators.pattern(this.secretNamePattern)])],data:["",i.Validators.pattern(this.dataPattern)]})}get secretName(){return this.form.get("secretName")}get data(){return this.form.get("data")}createSecret(){if(!this.form.valid)return;const t={name:this.secretName.value,namespace:this.data_.namespace,data:this.data.value};this.csrfToken_.getTokenForAction("secret").pipe((0,ie.w)(a=>this.http_.post("api/v1/secret/",{...t},{headers:(new N.WM).set(this.appConfig_.csrfHeaderName,a.token)}))).subscribe(()=>{this.dialogRef.close(this.secretName.value)},a=>{this.dialogRef.close(),this.matDialog_.open(X.a,{data:{title:"Error creating secret",message:a.data,confirmLabel:"OK"}})})}cancel(){this.dialogRef.close()}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(u.so),e.\u0275\u0275directiveInject(u.WI),e.\u0275\u0275directiveInject(N.eN),e.\u0275\u0275directiveInject(k.Q),e.\u0275\u0275directiveInject(u.uw),e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(x.ED))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create-secret-dialog"]],decls:39,vars:8,consts:function(){let o,t,r,a,_,s,c,d,p,R,T,f,S,A;return o="Create a new image pull secret",t="\u5C06\u65B0\u7684 secret \u6DFB\u52A0\u5230\u96C6\u7FA4\u4E2D",r="Secret \u540D\u79F0",a="\u5177\u6709\u6307\u5B9A\u540D\u79F0\u7684 secret \u5C06\u6DFB\u52A0\u5230\u547D\u540D\u7A7A\u95F4\u4E2D\u7684\u96C6\u7FA4\u4E2D\u3002",_=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#21\ufffd" + "open_in_new" + "\ufffd/#21\ufffd" + "",s="\u6307\u5B9A\u8981\u4FDD\u7559\u7684 secret \u7684 data \u3002\u8BE5\u503C\u662F .dockercfg \u6587\u4EF6\u4E2D\u7684 Base64 \u7F16\u7801\u5185\u5BB9\u3002",c=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#32\ufffd" + "open_in_new" + "\ufffd/#32\ufffd" + "",d="Create",p="Cancel",R=" \u540D\u79F0\u662F\u5FC5\u586B\u7684\u3002 ",T=" \u540D\u79F0\u5FC5\u987B\u5927\u4E8E " + "\ufffd0\ufffd" + " \u4E2A\u5B57\u7B26\u3002",f=" \u540D\u79F0\u5FC5\u987B\u9075\u5FAA DNS \u57DF\u540D\u8BED\u6CD5\uFF08\u4F8B\u5982 new.image-pull.secret\uFF09\u3002",S=" Data \u662F\u5FC5\u9700\u7684\u3002",A=" Data \u5FC5\u987B\u662F Base64 \u7F16\u7801\u7684\u3002",[["mat-dialog-title",""],o,[1,"kd-dialog-text"],t,[3,"formGroup"],["matInput","","type","text","placeholder",r,"name","secretName","formControlName","secretName","required",""],["align","end"],[4,"ngIf"],a,["href","https://kubernetes.io/docs/user-guide/secrets/","target","_blank","tabindex","-1"],_,[1,"material-icons"],["matInput","","type","text","placeholder","Image pull secret data","name","data","formControlName","data","required",""],s,["href","https://kubernetes.io/docs/user-guide/images/#specifying-imagepullsecrets-on-a-pod","target","_blank","tabindex","-1"],c,["mat-button","","type","submit","color","primary",3,"click"],d,["mat-button","",3,"click"],p,R,T,f,S,A]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"h4",0),e.\u0275\u0275i18n(1,1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"mat-dialog-content",2),e.\u0275\u0275elementContainerStart(3),e.\u0275\u0275elementStart(4,"div"),e.\u0275\u0275i18n(5,3),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div")(7,"form",4)(8,"kd-help-section")(9,"mat-form-field"),e.\u0275\u0275element(10,"input",5),e.\u0275\u0275elementStart(11,"mat-hint",6),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,gt,2,0,"mat-error",7),e.\u0275\u0275template(14,Ct,2,1,"mat-error",7),e.\u0275\u0275template(15,Mt,2,0,"mat-error",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"kd-user-help")(17,"span"),e.\u0275\u0275i18n(18,8),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(19,"a",9),e.\u0275\u0275i18nStart(20,10),e.\u0275\u0275element(21,"i",11),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(22,"kd-help-section")(23,"mat-form-field"),e.\u0275\u0275element(24,"input",12),e.\u0275\u0275template(25,Nt,2,0,"mat-error",7),e.\u0275\u0275template(26,Ft,2,0,"mat-error",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(27,"kd-user-help"),e.\u0275\u0275elementContainerStart(28),e.\u0275\u0275i18n(29,13),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(30,"a",14),e.\u0275\u0275i18nStart(31,15),e.\u0275\u0275element(32,"i",11),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"mat-dialog-actions",6),e.\u0275\u0275elementContainerStart(34),e.\u0275\u0275elementStart(35,"button",16),e.\u0275\u0275listener("click",function(){return r.createSecret()}),e.\u0275\u0275i18n(36,17),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(37,"button",18),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275i18n(38,19),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(7),e.\u0275\u0275property("formGroup",r.form),e.\u0275\u0275advance(5),e.\u0275\u0275textInterpolate2("",r.secretName.value.length," / ",r.secretNameMaxLength,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.secretName.errors?null:r.secretName.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.secretName.errors?null:r.secretName.errors.maxlength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.secretName.errors?null:r.secretName.errors.pattern),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",null==r.data.errors?null:r.data.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.data.errors?null:r.data.errors.pattern))},directives:[u.uh,u.xY,i.\u0275NgNoValidate,i.NgControlStatusGroup,i.FormGroupDirective,q,g.KE,h.Nt,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,i.RequiredValidator,g.bx,C.NgIf,g.TO,Y,u.H8,F.lW],encapsulation:2}),n})();var se=m(3162),me=m(5829);let St=(()=>{class n{constructor(t){this.http=t}validate(t){return t.value?this.http.post("api/v1/appdeployment/validate/imagereference",{reference:t.value}).pipe((0,j.b)(500),(0,b.U)(r=>r.valid?null:{validImageReference:r.reason})):(0,y.of)(null)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(N.eN))},n.\u0275dir=e.\u0275\u0275defineDirective({type:n,selectors:[["","kdValidImageReference",""]],inputs:{namespace:"namespace"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_ASYNC_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])]}),n})(),At=(()=>{class n{constructor(){}validate(t){return this.shouldSetWarning(t.value)?(this.hasWarning=!0,{warnThreshold:{value:"333"}}):(this.shouldRemoveWarning(t.value)&&(this.hasWarning=!1),null)}shouldSetWarning(t){return t>this.kdWarnThreshold}shouldRemoveWarning(t){return!this.hasWarning&&!this.shouldSetWarning(t)}}return n.\u0275fac=function(t){return new(t||n)},n.\u0275dir=e.\u0275\u0275defineDirective({type:n,selectors:[["","kdWarnThreshold",""]],inputs:{kdWarnThreshold:"kdWarnThreshold"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])]}),n})();var Pt=m(8675),ht=m(9300);let $t=(()=>{class n{constructor(t){this.http=t}validate(t){return ce(this.http,this.isExternal)(t)}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(N.eN))},n.\u0275dir=e.\u0275\u0275defineDirective({type:n,selectors:[["","kdValidProtocol",""]],inputs:{isExternal:"isExternal"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_ASYNC_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])]}),n})();function ce(n,o){return t=>t.value?n.post("api/v1/appdeployment/validate/protocol",{protocol:t.value,isExternal:o}).pipe((0,L.q)(1)).pipe((0,j.b)(500),(0,b.U)(a=>a.valid?null:{validProtocol:!0})):(0,y.of)(null)}var de=m(4385),Ee=m(3238),B=m(7392);function vt(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-option",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t.label," ")}}function yt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,19),e.\u0275\u0275elementEnd())}function Dt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,20),e.\u0275\u0275elementEnd())}function Lt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,21),e.\u0275\u0275elementEnd())}function bt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,22),e.\u0275\u0275elementEnd())}function Gt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,23),e.\u0275\u0275elementEnd())}function xt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,24),e.\u0275\u0275elementEnd())}function Xt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,25),e.\u0275\u0275elementEnd())}function kt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,26),e.\u0275\u0275elementEnd())}function Vt(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-option",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(t)}}function wt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,27),e.\u0275\u0275elementEnd())}function zt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,28),e.\u0275\u0275elementEnd())}function qt(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",29),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().index;return e.\u0275\u0275nextContext().remove(a)}),e.\u0275\u0275elementStart(1,"mat-icon"),e.\u0275\u0275text(2,"delete"),e.\u0275\u0275elementEnd()()}}const Yt=function(n){return{"kd-deploy-form-progress-show":n}};function jt(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",8)(1,"mat-form-field",9)(2,"input",10),e.\u0275\u0275listener("change",function(){const _=e.\u0275\u0275restoreView(t).index;return e.\u0275\u0275nextContext().checkPortMapping(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,yt,2,0,"mat-error",11),e.\u0275\u0275template(4,Dt,2,0,"mat-error",11),e.\u0275\u0275template(5,Lt,2,0,"mat-error",11),e.\u0275\u0275template(6,bt,2,0,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(7,"p",12),e.\u0275\u0275elementStart(8,"mat-form-field",9)(9,"input",13),e.\u0275\u0275listener("change",function(){const _=e.\u0275\u0275restoreView(t).index;return e.\u0275\u0275nextContext().checkPortMapping(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(10,Gt,2,0,"mat-error",11),e.\u0275\u0275template(11,xt,2,0,"mat-error",11),e.\u0275\u0275template(12,Xt,2,0,"mat-error",11),e.\u0275\u0275template(13,kt,2,0,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(14,"p",12),e.\u0275\u0275elementStart(15,"mat-form-field",14)(16,"mat-select",15),e.\u0275\u0275template(17,Vt,2,2,"mat-option",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(18,"mat-progress-bar",16),e.\u0275\u0275template(19,wt,2,0,"mat-error",11),e.\u0275\u0275template(20,zt,2,0,"mat-error",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"div",17),e.\u0275\u0275template(22,qt,3,0,"button",18),e.\u0275\u0275elementEnd()()}if(2&n){const t=o.$implicit,r=o.index,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroupName",r),e.\u0275\u0275advance(2),e.\u0275\u0275property("required",a.isFirst(r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("port").errors?null:t.get("port").errors.kdValidInteger),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("port").errors?null:t.get("port").errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("port").errors?null:t.get("port").errors.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("port").errors?null:t.get("port").errors.max),e.\u0275\u0275advance(3),e.\u0275\u0275property("required",a.isFirst(r)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("targetPort").errors?null:t.get("targetPort").errors.kdValidInteger),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("targetPort").errors?null:t.get("targetPort").errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("targetPort").errors?null:t.get("targetPort").errors.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("targetPort").errors?null:t.get("targetPort").errors.max),e.\u0275\u0275advance(3),e.\u0275\u0275property("isExternal",a.isExternal),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",a.protocols),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(17,Yt,t.get("protocol").pending)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("protocol").errors?null:t.get("protocol").errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("protocol").errors?null:t.get("protocol").errors.validProtocol),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",a.isRemovable(r))}}const U={label:"None",external:!1},Bt={label:"Internal",external:!1},Kt={label:"External",external:!0};let Ut=(()=>{class n{constructor(t,r){this.fb_=t,this.http_=r,this.changeExternal=new e.EventEmitter,this.propagateChange=a=>{}}ngOnInit(){this.serviceTypes=[U,Bt,Kt],this.portMappingForm=this.fb_.group({serviceType:U,portMappings:this.fb_.array([])}),this.serviceType.valueChanges.subscribe(()=>{this.changeServiceType()}),this.portMappingForm.valueChanges.subscribe(t=>{this.propagateChange(t)})}validate(t){return this.portMappingForm.statusChanges.pipe((0,Pt.O)(this.portMappingForm.status),(0,ht.h)(()=>!this.portMappingForm.pending),(0,L.q)(1),(0,b.U)(()=>this.portMappingForm.invalid?{error:!0}:null))}changeServiceType(){if(this.serviceType.value===U){const t=this.portMappings.length;for(let r=0;r<t;r++)this.portMappings.removeAt(0)}else 0===this.portMappings.length&&this.portMappings.push(this.newEmptyPortMapping(this.protocols[0]));this.isExternal=this.serviceType.value.external,this.changeExternal.emit(this.isExternal);for(let t=0;t<this.portMappings.length;t++){const r=this.portMappings.at(t).get("protocol");r.clearAsyncValidators(),r.setAsyncValidators(ce(this.http_,this.isExternal)),r.updateValueAndValidity()}}get portMappings(){return this.portMappingForm.get("portMappings")}get serviceType(){return this.portMappingForm.get("serviceType")}newEmptyPortMapping(t){return this.fb_.group({port:["",i.Validators.compose([M.isInteger,i.Validators.min(1),i.Validators.max(65535)])],targetPort:["",i.Validators.compose([M.isInteger,i.Validators.min(1),i.Validators.max(65535)])],protocol:[t]})}checkPortMapping(t){this.addProtocolIfNeeed(),this.validatePortMapping(t),this.portMappings.updateValueAndValidity()}addProtocolIfNeeed(){this.isPortMappingFilled(this.portMappings.controls[this.portMappings.length-1])&&this.portMappings.push(this.newEmptyPortMapping(this.protocols[0]))}isPortMappingFilled(t){return!!t.get("port").value&&!!t.get("targetPort").value}validatePortMapping(t){if(0===t)return;const r=this.portMappings.at(t),a=r.get("port"),_=r.get("targetPort"),s=a.value,c=_.value,d=this.isPortMappingFilledOrEmpty(s,c),R=d||!!c;a.setErrors(d||s?null:{required:!0}),_.setErrors(R?null:{required:!0}),this.portMappingForm.updateValueAndValidity()}isPortMappingFilledOrEmpty(t,r){return!t==!r}isRemovable(t){return t!==this.portMappings.length-1}remove(t){this.portMappings.removeAt(t)}isFirst(t){return 0===t}writeValue(){}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(N.eN))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-port-mappings"]],inputs:{protocols:"protocols",isExternal:"isExternal"},outputs:{changeExternal:"changeExternal"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>n),multi:!0},{provide:i.NG_ASYNC_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])],decls:8,vars:3,consts:function(){let o,t,r,a,_,s,c,d,p,R,T,f,S,A;return o="Service",t="\u7AEF\u53E3",r="\u76EE\u6807\u7AEF\u53E3",a="\u534F\u8BAE",_=" \u7AEF\u53E3\u53F7\u5FC5\u987B\u662F\u6570\u5B57\u3002",s=" \u7AEF\u53E3\u53F7\u4E0D\u80FD\u4E3A\u7A7A\u3002",c=" \u7AEF\u53E3\u53F7\u5FC5\u987B\u5927\u4E8E 0\u3002",d=" \u7AEF\u53E3\u53F7\u5FC5\u987B\u5C0F\u4E8E 65536\u3002",p=" \u76EE\u6807\u7AEF\u53E3\u5FC5\u987B\u662F\u6574\u6570\u3002 ",R=" \u76EE\u6807\u7AEF\u53E3\u4E0D\u80FD\u4E3A\u7A7A\u3002",T=" \u76EE\u6807\u7AEF\u53E3\u5FC5\u987B\u5927\u4E8E 0\u3002",f=" \u76EE\u6807\u7AEF\u53E3\u5FC5\u987B\u5C0F\u4E8E 65536\u3002",S=" \u534F\u8BAE\u662F\u5FC5\u9700\u7684\u3002",A=" \u65E0\u6548\u7684\u534F\u8BAE\u3002",[["fxLayout","column",3,"formGroup"],["fxLayout","row"],[1,"mat-block","kd-deploy-input-row",2,"width","100%"],["namespace","serviceType","formControlName","serviceType","placeholder",o,"required",""],[3,"value",4,"ngFor","ngForOf"],["formArrayName","portMappings"],["fxLayout","row",3,"formGroupName",4,"ngFor","ngForOf"],[3,"value"],["fxLayout","row",3,"formGroupName"],["md-no-float","","fxFlex","30",1,"kd-deploy-input-row","kd-port-form-field"],["matInput","","type","number","name","port","formControlName","port","placeholder",t,3,"required","change"],[4,"ngIf"],["fxFlex","5"],["matInput","","type","number","name","targetPort","formControlName","targetPort","placeholder",r,"min","1","max","65535",3,"required","change"],["md-no-float","","fxFlex","20",1,"kd-deploy-input-row","kd-port-form-field"],["name","protocol","formControlName","protocol","placeholder",a,"kdValidProtocol","","required","",3,"isExternal"],["mode","indeterminate",1,"kd-deploy-form-progress",3,"ngClass"],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],_,s,c,d,p,R,T,f,S,A,["mat-icon-button","",3,"click"]]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1)(2,"mat-form-field",2)(3,"mat-select",3),e.\u0275\u0275template(4,vt,2,2,"mat-option",4),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerStart(5)(6,5),e.\u0275\u0275template(7,jt,23,19,"div",6),e.\u0275\u0275elementContainerEnd()(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("formGroup",r.portMappingForm),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngForOf",r.serviceTypes),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngForOf",r.portMappings.controls))},directives:[O.xw,i.NgControlStatusGroup,i.FormGroupDirective,g.KE,de.gD,i.NgControlStatus,i.FormControlName,i.RequiredValidator,C.NgForOf,Ee.ey,i.FormArrayName,i.FormGroupName,O.yH,h.Nt,i.NumberValueAccessor,i.DefaultValueAccessor,C.NgIf,g.TO,i.MinValidator,i.MaxValidator,$t,se.pW,C.NgClass,me.oO,F.lW,B.Hw],styles:[".kd-port-form-field[_ngcontent-%COMP%]{margin:0 0 18px}"]}),n})();function Wt(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,14),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext().$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(t.get("key").value),e.\u0275\u0275i18nApply(1)}}function Ht(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,15),e.\u0275\u0275elementEnd())}function Jt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,16),e.\u0275\u0275elementEnd())}function Qt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,17),e.\u0275\u0275elementEnd())}function Zt(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,18),e.\u0275\u0275elementEnd())}function en(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,19),e.\u0275\u0275elementEnd())}function tn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,20),e.\u0275\u0275elementEnd())}function nn(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",21),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().index;return e.\u0275\u0275nextContext().deleteLabel(a)}),e.\u0275\u0275elementStart(1,"mat-icon"),e.\u0275\u0275text(2,"delete"),e.\u0275\u0275elementEnd()()}}function rn(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",3)(1,"mat-form-field",4)(2,"input",5),e.\u0275\u0275listener("keyup",function(){const _=e.\u0275\u0275restoreView(t).index;return e.\u0275\u0275nextContext().check(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Wt,2,1,"mat-error",6),e.\u0275\u0275template(4,Ht,2,0,"mat-error",6),e.\u0275\u0275template(5,Jt,2,0,"mat-error",6),e.\u0275\u0275template(6,Qt,2,0,"mat-error",6),e.\u0275\u0275template(7,Zt,2,0,"mat-error",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(8,"p",7),e.\u0275\u0275elementStart(9,"mat-form-field",8)(10,"input",9),e.\u0275\u0275listener("keyup",function(){const _=e.\u0275\u0275restoreView(t).index;return e.\u0275\u0275nextContext().check(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"mat-hint",10),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(13,en,2,0,"mat-error",6),e.\u0275\u0275template(14,tn,2,0,"mat-error",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(15,"input",11),e.\u0275\u0275elementStart(16,"div",12),e.\u0275\u0275template(17,nn,3,0,"button",13),e.\u0275\u0275elementEnd()()}if(2&n){const t=o.$implicit,r=o.index,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroupName",r),e.\u0275\u0275advance(2),e.\u0275\u0275property("readonly",!t.get("editable").value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("key").errors?null:t.get("key").errors.unique),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("key").errors?null:t.get("key").errors.kdValidLabelKeyPrefixPattern),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("key").errors?null:t.get("key").errors.kdValidLabelKeyNamePattern),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("key").errors?null:t.get("key").errors.kdValidLabelKeyPrefixLength),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("key").errors?null:t.get("key").errors.kdValidLabelKeyNameLength),e.\u0275\u0275advance(3),e.\u0275\u0275property("readonly",!t.get("editable").value),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1("",null==t.get("value").value?null:t.get("value").value.length," / 253"),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("value").errors?null:t.get("value").errors.kdValidLabelValuePattern),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==t.get("value").errors?null:t.get("value").errors.maxlength),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",a.isRemovable(r))}}let on=(()=>{class n{constructor(t){this.fb_=t,this.propagateChange=r=>{}}ngOnInit(){this.labelForm=this.fb_.group({labels:this.fb_.array([])}),this.labelForm.valueChanges.subscribe(t=>{this.propagateChange(t)});for(let t=0;t<this.labelArr.length;t++)this.addNewLabel(this.labelArr[t].key,this.labelArr[t].value,this.labelArr[t].editable)}validate(t){return this.labelForm.valid?null:{labelValid:{value:this.labels.at(0).errors}}}get labels(){return this.labelForm.get("labels")}addNewLabel(t="",r="",a=!0){this.labels.push(this.fb_.group({key:[{value:t,disabled:!a},i.Validators.compose([M.labelKeyNameLength,M.labelKeyNamePattern,M.labelKeyPrefixLength,M.labelKeyPrefixPattern])],value:[{value:r,disabled:!a},i.Validators.compose([i.Validators.maxLength(253),M.labelValuePattern])],editable:a}))}check(t){this.addIfNeeded(),this.validateKey(t)}isRemovable(t){const r=this.labels.at(this.labels.length-1),a=this.labels.at(t),_=a.get("key").value,s=a.get("value").value,c=a.get("editable").value,d=r.get("key").value,p=r.get("value").value;return!(!c||_===d||s===p)}deleteLabel(t){this.labels.removeAt(t)}validateKey(t){const r=this.labels.at(t).get("key"),a=!this.isKeyDuplicated(t);r.setErrors(a?null:{unique:!0}),this.labelForm.updateValueAndValidity()}isKeyDuplicated(t){let r=0;const a=this.labels.at(t).get("key").value;for(let _=0;_<this.labels.length;_++){const s=this.labels.at(_).get("key").value;if(0!==s.length&&s===a&&r++,r>1)return!0}return!1}addIfNeeded(){const t=this.labels.at(this.labels.length-1);this.isFilled(t)&&this.addNewLabel()}isFilled(t){return 0!==t.get("key").value.length&&0!==t.get("value").value.length}writeValue(t){t.length>0&&this.labels.at(t[0].index).patchValue({value:t[0].value})}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(i.FormBuilder))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-deploy-label"]],inputs:{labelArr:"labelArr"},features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>n),multi:!0},{provide:i.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])],decls:3,vars:2,consts:function(){let o,t,r,a,_,s,c,d,p;return o="\u5BC6\u94A5",t="\u503C",r="\n          " + "\ufffd0\ufffd" + " \u4E0D\u662F\u552F\u4E00\u7684\n        ",a=" \u524D\u7F00\u4E0D\u662F\u6709\u6548\u7684DNS\u5B50\u57DF\u524D\u7F00\uFF08\u4F8B\u5982 my-domain.com \uFF09\u3002",_=" \u6807\u7B7E\u5BC6\u94A5\u540D\u79F0\u5FC5\u987B\u662F\u7531 \u201C - \u201D\uFF0C\u201C_\u201D \u6216 \u201C.\u201D \u5206\u9694\u7684\u5B57\u6BCD\u6570\u5B57\uFF0C\u53EF\u9009\u4EE5 DNS \u5B50\u57DF\u548C\u201C/\u201D\u4E3A\u524D\u7F00\u3002",s=" \u524D\u7F00\u4E0D\u5E94\u8D85\u8FC7 253 \u4E2A\u5B57\u7B26\u3002",c=" Label Key \u540D\u79F0\u4E0D\u5E94\u8D85\u8FC7 63 \u4E2A\u5B57\u7B26\u3002",d=" \u6807\u7B7E\u503C\u5FC5\u987B\u7531'.' , '-'\u6216\u8005'_'\u5206\u5272\u5B57\u6BCD\u6570\u5B57\u3002",p=" \u6807\u7B7E\u503C\u4E0D\u5F97\u8D85\u8FC7 253 \u4E2A\u5B57\u7B26\u3002",[[3,"formGroup"],["formArrayName","labels"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["md-no-float","","fxFlex","45",1,"kd-deploy-input-row"],["matInput","","name","key","formControlName","key","placeholder",o,3,"readonly","keyup"],[4,"ngIf"],["fxFlex","5"],["md-no-float","","fxFlex","40",1,"kd-deploy-input-row"],["matInput","","name","value","formControlName","value","placeholder",t,3,"readonly","keyup"],["align","end"],["type","hidden","formControlName","editable"],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],r,a,_,s,c,d,p,["mat-icon-button","",3,"click"]]},template:function(t,r){1&t&&(e.\u0275\u0275elementContainerStart(0,0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275template(2,rn,18,12,"div",2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&t&&(e.\u0275\u0275property("formGroup",r.labelForm),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.labels.controls))},directives:[i.NgControlStatusGroup,i.FormGroupDirective,i.FormArrayName,C.NgForOf,i.FormGroupName,g.KE,O.yH,h.Nt,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,C.NgIf,g.TO,g.bx,F.lW,B.Hw],encapsulation:2}),n})();var an=m(6709);function _n(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,14),e.\u0275\u0275elementEnd())}function ln(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",15),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(t);const a=e.\u0275\u0275nextContext().index;return e.\u0275\u0275nextContext().remove(a)}),e.\u0275\u0275elementStart(1,"mat-icon"),e.\u0275\u0275text(2,"delete"),e.\u0275\u0275elementEnd()()}}function sn(n,o){if(1&n){const t=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"mat-form-field",7)(2,"input",8),e.\u0275\u0275listener("change",function(){const _=e.\u0275\u0275restoreView(t).index;return e.\u0275\u0275nextContext().addVariableIfNeeed(_)}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,_n,2,0,"mat-error",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(4,"div",10),e.\u0275\u0275elementStart(5,"mat-form-field",7),e.\u0275\u0275element(6,"input",11),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",12),e.\u0275\u0275template(8,ln,3,0,"button",13),e.\u0275\u0275elementEnd()()}if(2&n){const t=o.$implicit,r=o.index,a=e.\u0275\u0275nextContext();e.\u0275\u0275property("formGroupName",r),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",null==t.get("name").errors?null:t.get("name").errors.pattern),e.\u0275\u0275advance(5),e.\u0275\u0275property("ngIf",a.isRemovable(r))}}let mn=(()=>{class n{constructor(t){this.fb_=t,this.namePattern=new RegExp("^[A-Za-z_][A-Za-z0-9_]*$"),this.propagateChange=r=>{}}ngOnInit(){this.form=this.fb_.group({variables:this.fb_.array([this.newVariable()])}),this.form.valueChanges.subscribe(t=>{this.propagateChange(t)})}validate(t){return this.form.valid?null:{labelValid:{value:this.form.errors}}}get variables(){return this.form.get("variables")}addVariableIfNeeed(){const t=this.variables.at(this.variables.length-1);this.isVariableFilled(t)&&t.valid&&this.variables.push(this.newVariable())}isVariableFilled(t){return!!t.get("name").value}newVariable(){return this.fb_.group({name:["",i.Validators.pattern(this.namePattern)],value:""})}isRemovable(t){return t!==this.variables.length-1}remove(t){this.variables.removeAt(t)}writeValue(){}registerOnChange(t){this.propagateChange=t}registerOnTouched(){}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject(i.FormBuilder))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-environment-variables"]],features:[e.\u0275\u0275ProvidersFeature([{provide:i.NG_VALUE_ACCESSOR,useExisting:(0,e.forwardRef)(()=>n),multi:!0},{provide:i.NG_VALIDATORS,useExisting:(0,e.forwardRef)(()=>n),multi:!0}])],decls:6,vars:2,consts:function(){let o,t,r,a;return o="Environment variables",t="\u540D\u79F0",r="\u503C",a=" \u53D8\u91CF\u540D\u5FC5\u987B\u662F\u6709\u6548\u7684 C \u6807\u8BC6\u7B26\u3002",[["fxLayout","column"],[1,"kd-margin-bottom"],o,[3,"formGroup"],["formArrayName","variables"],[3,"formGroupName",4,"ngFor","ngForOf"],[3,"formGroupName"],["fxFlex","auto"],["matInput","","name","name","formControlName","name","placeholder",t,3,"change"],[4,"ngIf"],["fxFlex","5"],["matInput","","name","value","formControlName","value","placeholder",r],["fxFlex","10"],["mat-icon-button","",3,"click",4,"ngIf"],a,["mat-icon-button","",3,"click"]]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0)(1,"div",1),e.\u0275\u0275i18n(2,2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerStart(3,3)(4,4),e.\u0275\u0275template(5,sn,9,3,"div",5),e.\u0275\u0275elementContainerEnd()(),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(3),e.\u0275\u0275property("formGroup",r.form),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngForOf",r.variables.controls))},directives:[O.xw,i.NgControlStatusGroup,i.FormGroupDirective,i.FormArrayName,C.NgForOf,i.FormGroupName,g.KE,O.yH,h.Nt,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,C.NgIf,g.TO,F.lW,B.Hw],encapsulation:2}),n})();function cn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,73),e.\u0275\u0275elementEnd())}function dn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,74),e.\u0275\u0275elementEnd())}function En(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,75),e.\u0275\u0275elementEnd())}function un(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,76),e.\u0275\u0275elementEnd())}function pn(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,77),e.\u0275\u0275elementEnd()),2&n){const t=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(null==t.containerImage.errors?null:t.containerImage.errors.validImageReference),e.\u0275\u0275i18nApply(1)}}function Rn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,78),e.\u0275\u0275elementEnd())}function Tn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,79),e.\u0275\u0275elementEnd())}function gn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,80),e.\u0275\u0275elementEnd())}function Cn(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-option",81),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function Mn(n,o){if(1&n&&(e.\u0275\u0275elementStart(0,"mat-option",81),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&n){const t=o.$implicit;e.\u0275\u0275property("value",t),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",t," ")}}function Nn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,82),e.\u0275\u0275elementEnd())}function Fn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,83),e.\u0275\u0275elementEnd())}function On(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,84),e.\u0275\u0275elementEnd())}function fn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"mat-error"),e.\u0275\u0275i18n(1,85),e.\u0275\u0275elementEnd())}const Sn=function(n){return{"kd-deploy-form-progress-show":n}};let ue=(()=>{class n extends D{constructor(t,r,a,_,s,c,d,p){super(),this.namespace_=t,this.create_=r,this.history_=a,this.http_=_,this.route_=s,this.fb_=c,this.dialog_=d,this.router_=p,this.showMoreOptions_=!1,this.isExternal=!1,this.labelArr=[],this.nameMaxLength=24,this.created_=!1,this.unsubscribe_=new re.x}get name(){return this.form.get("name")}get containerImage(){return this.form.get("containerImage")}get replicas(){return this.form.get("replicas")}get description(){return this.form.get("description")}get namespace(){return this.form.get("namespace")}get imagePullSecret(){return this.form.get("imagePullSecret")}get cpuRequirement(){return this.form.get("cpuRequirement")}get memoryRequirement(){return this.form.get("memoryRequirement")}get containerCommand(){return this.form.get("containerCommand")}get containerCommandArgs(){return this.form.get("containerCommandArgs")}get runAsPrivileged(){return this.form.get("runAsPrivileged")}get portMappings(){return this.form.get("portMappings")}get variables(){return this.form.get("variables")}get labels(){return this.form.get("labels")}ngOnInit(){this.form=this.fb_.group({name:["",i.Validators.compose([i.Validators.required,M.namePattern])],containerImage:["",i.Validators.required],replicas:[1,i.Validators.compose([i.Validators.required,M.isInteger])],description:[""],namespace:[this.route_.snapshot.params.namespace||"",i.Validators.required],imagePullSecret:[""],cpuRequirement:["",i.Validators.compose([i.Validators.min(0),M.isInteger])],memoryRequirement:["",i.Validators.compose([i.Validators.min(0),M.isInteger])],containerCommand:[""],containerCommandArgs:[""],runAsPrivileged:[!1],portMappings:this.fb_.control([]),variables:this.fb_.control([]),labels:this.fb_.control([])}),this.labelArr=[new _e("k8s-app","",!1),new _e],this.name.valueChanges.subscribe(t=>{this.labelArr[0].value=t,this.labels.patchValue([{index:0,value:t}])}),this.namespace.valueChanges.pipe((0,oe.R)(this.unsubscribe_)).subscribe(t=>{this.name.clearAsyncValidators(),this.name.setAsyncValidators(le(this.http_,t)),this.name.updateValueAndValidity()}),this.http_.get("api/v1/namespace").subscribe(t=>{this.namespaces=t.namespaces.map(r=>r.objectMeta.name),this.namespace.patchValue(this.namespace_.areMultipleNamespacesSelected()?this.namespaces[0]:this.route_.snapshot.params.namespace||this.namespaces[0]),this.form.markAsPristine()}),this.http_.get("api/v1/appdeployment/protocols").subscribe(t=>this.protocols=t.protocols)}ngOnDestroy(){this.unsubscribe_.next(),this.unsubscribe_.complete()}changeExternal(t){this.isExternal=t}resetImagePullSecret(){this.imagePullSecret.patchValue("")}hasUnsavedChanges(){return this.form.dirty}isCreateDisabled(){return!this.form.valid||this.create_.isDeployDisabled()}getSecrets(){this.http_.get(`api/v1/secret/${this.namespace.value}`).subscribe(t=>{this.secrets=t.secrets.map(r=>r.objectMeta.name)})}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}isMoreOptionsEnabled(){return this.showMoreOptions_}switchMoreOptions(){this.showMoreOptions_=!this.showMoreOptions_}handleNamespaceDialog(){this.dialog_.open(pt,{data:{namespaces:this.namespaces}}).afterClosed().pipe((0,L.q)(1)).subscribe(a=>{a?(this.namespaces.push(a),this.namespace.patchValue(a)):this.namespace.patchValue(this.namespaces[0])})}handleCreateSecretDialog(){this.dialog_.open(Ot,{data:{namespace:this.namespace.value}}).afterClosed().pipe((0,L.q)(1)).subscribe(a=>{a?(this.secrets.push(a),this.imagePullSecret.patchValue(a)):this.imagePullSecret.patchValue("")})}isPortMappingFilled(t){return!!t.port&&!!t.targetPort}isVariableFilled(t){return!!t.name}isNumber(t){return"number"==typeof t&&!isNaN(t)}toBackendApiLabels(t){return t[0].key=this.labelArr[0].key,t[0].value=this.labelArr[0].value,t.filter(r=>0!==r.key.length&&0!==r.value.length)}preview(){this.dialog_.open(st,{width:"900px",data:{spec:this.getSpec()}})}deploy(){const t=this.getSpec();this.create_.deploy(t).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[w.x]:t.namespace}})})}getSpec(){const r=this.variables.value.variables||[],a=this.labels.value.labels||[];return{containerImage:this.containerImage.value,imagePullSecret:this.imagePullSecret.value?this.imagePullSecret.value:null,containerCommand:this.containerCommand.value?this.containerCommand.value:null,containerCommandArgs:this.containerCommandArgs.value?this.containerCommandArgs.value:null,isExternal:this.isExternal,name:this.name.value,description:this.description.value?this.description.value:null,portMappings:(this.portMappings.value.portMappings||[]).filter(this.isPortMappingFilled),variables:r.filter(this.isVariableFilled),replicas:this.replicas.value,namespace:this.namespace.value,cpuRequirement:this.isNumber(this.cpuRequirement.value)?this.cpuRequirement.value:null,memoryRequirement:this.isNumber(this.memoryRequirement.value)?`${this.memoryRequirement.value}Mi`:null,labels:this.toBackendApiLabels(a),runAsPrivileged:this.runAsPrivileged.value}}canDeactivate(){return this.form.pristine||this.created_}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject($.L),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(z.q),e.\u0275\u0275directiveInject(N.eN),e.\u0275\u0275directiveInject(P.ActivatedRoute),e.\u0275\u0275directiveInject(i.FormBuilder),e.\u0275\u0275directiveInject(u.uw),e.\u0275\u0275directiveInject(P.Router))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create-from-form"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:144,vars:30,consts:function(){let o,t,r,a,_,s,c,d,p,R,T,f,S,A,E,Te,ge,Ce,Me,Ne,Fe,Oe,fe,Se,Ae,Pe,he,Ie,$e,ve,ye,De,Le,be,Ge,xe,Xe,ke,Ve,we,G,ze,qe,Ye,je,Be,Ke,Ue,We,He,Je,Qe,Ze,et;return o="\u5E94\u7528\u540D\u79F0",t="\u5177\u6709\u6B64\u503C\u7684 \u201Capp\u201D \u6807\u7B7E\u5C06\u6DFB\u52A0\u5230\u5DF2\u90E8\u7F72\u7684 Deployment \u548C Service \u4E2D\u3002",r=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#15\ufffd" + "open_in_new" + "\ufffd/#15\ufffd" + "",a="\u5BB9\u5668\u955C\u50CF",_="\u586B\u5199\u516C\u5171\u955C\u50CF\u7684 URL\uFF0C\u6216\u8005\u662F\u6258\u7BA1\u4E8E Docker Hub\u3001Google Container Registry \u7B49\u4ED3\u5E93\u4E0A\u7684\u79C1\u6709\u955C\u50CF URL\u3002",s=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#26\ufffd" + "open_in_new" + "\ufffd/#26\ufffd" + "",c="pod \u7684\u6570\u91CF",d="Deployment \u5C06\u8DE8\u96C6\u7FA4\u521B\u5EFA pod \u4EE5\u7EF4\u62A4\u6240\u9700\u6570\u91CF\u3002",p=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#38\ufffd" + "open_in_new" + "\ufffd/#38\ufffd" + "",R="\u53EF\u9009\u9879\uFF0C\u53EF\u4EE5\u5B9A\u4E49\u5185\u90E8\u6216\u5916\u90E8 Service\uFF0C\u5C06\u4F20\u5165\u7AEF\u53E3\u6620\u5C04\u5230\u5BB9\u5668\u7684\u76EE\u6807\u7AEF\u53E3\u3002",T=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#47\ufffd" + "open_in_new" + "\ufffd/#47\ufffd" + "",f="\u547D\u540D\u7A7A\u95F4",S=" \u521B\u5EFA\u4E00\u4E2A\u65B0\u7684\u547D\u540D\u7A7A\u95F4... ",A="\u547D\u540D\u7A7A\u95F4\u5141\u8BB8\u5C06\u8D44\u6E90\u5206\u533A\u4E3A\u903B\u8F91\u547D\u540D\u7684\u7EC4\u3002",E=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#59\ufffd" + "open_in_new" + "\ufffd/#59\ufffd" + "",Te="\u63CF\u8FF0",ge=" \u8BE5\u63CF\u8FF0\u5C06\u4F5C\u4E3A\u6CE8\u91CA\u6DFB\u52A0\u5230 Deployment \u4E2D\uFF0C\u5E76\u663E\u793A\u5728\u5E94\u7528\u7A0B\u5E8F\u7684\u8BE6\u7EC6\u4FE1\u606F\u4E2D\u3002",Ce="\u6807\u7B7E",Me="\u6307\u5B9A\u7684\u6807\u7B7E\u5C06\u5E94\u7528\u4E8E\u521B\u5EFA\u7684 Deployment\uFF0CService\uFF08\u5982\u679C\u6709\uFF09\u548C Pod\u3002 \u5E38\u89C1\u6807\u7B7E\u5305\u62EC release\uFF0Cenvironment\uFF0Ctier\uFF0Cpartition \u548C track\u3002",Ne=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#76\ufffd" + "open_in_new" + "\ufffd/#76\ufffd" + "",Fe="\u62C9\u53D6\u955C\u50CF\u7684 Secret",Oe=" \u521B\u5EFA\u4E00\u4E2A\u65B0\u7684 secret... ",fe="\u5982\u679C\u6307\u5B9A\u7684\u955C\u50CF\u662F\u79C1\u6709\u7684\uFF0C\u5219\u53EF\u80FD\u9700\u8981\u62C9\u53D6 secret \u51ED\u636E\u3002 \u60A8\u53EF\u4EE5\u9009\u62E9\u73B0\u6709 secret \u6216\u521B\u5EFA\u65B0 secret\u3002",Se=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#88\ufffd" + "open_in_new" + "\ufffd/#88\ufffd" + "",Ae="CPU \u4E0B\u9650 (cores)",Pe="\u5185\u5B58\u4E0B\u9650 (MiB)",he="\u60A8\u53EF\u4EE5\u6307\u5B9A\u5BB9\u5668\u7684\u6700\u4F4E CPU \u548C\u5185\u5B58\u9700\u6C42\u3002",Ie=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#105\ufffd" + "open_in_new" + "\ufffd/#105\ufffd" + "",$e="\u8FD0\u884C\u547D\u4EE4",ve="\u8FD0\u884C\u547D\u4EE4\u53C2\u6570",ye="\u9ED8\u8BA4\u60C5\u51B5\u4E0B\uFF0C\u5BB9\u5668\u8FD0\u884C\u6240\u9009\u955C\u50CF\u7684\u9ED8\u8BA4 entrypoint \u547D\u4EE4\u3002 \u60A8\u53EF\u4EE5\u4F7F\u7528\u547D\u4EE4\u9009\u9879\u8986\u76D6\u9ED8\u8BA4\u503C\u3002",De=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#117\ufffd" + "open_in_new" + "\ufffd/#117\ufffd" + "",Le="\u4EE5\u7279\u6743\u8EAB\u4EFD\u8FD0\u884C",be="\u7279\u6743\u5BB9\u5668\u4E2D\u7684\u8FDB\u7A0B\u7B49\u540C\u4E8E\u5728\u4E3B\u673A\u4E0A\u4EE5root\u8EAB\u4EFD\u8FD0\u884C\u7684\u8FDB\u7A0B\u3002",Ge=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#127\ufffd" + "open_in_new" + "\ufffd/#127\ufffd" + "",xe="\u53EF\u5728\u5BB9\u5668\u4E2D\u4F7F\u7528\u7684\u73AF\u5883\u53D8\u91CF\u3002\u503C\u53EF\u4EE5\u4F7F\u7528 $(VAR_NAME) \u8BED\u6CD5\u5F15\u7528\u5176\u4ED6\u53D8\u91CF\u3002",Xe=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#135\ufffd" + "open_in_new" + "\ufffd/#135\ufffd" + "",ke=" \u90E8\u7F72 ",Ve=" Preview\n",we="Cancel",G="{VAR_SELECT, select, true {\u9690\u85CF\u9AD8\u7EA7\u9009\u9879} other {\u663E\u793A\u9AD8\u7EA7\u9009\u9879}}",G=e.\u0275\u0275i18nPostprocess(G,{VAR_SELECT:"\ufffd0\ufffd"}),ze=" " + G + "",qe=" \u5177\u6709\u6B64\u540D\u79F0\u7684 deployment \u6216 service \u5DF2\u5B58\u5728\u4E8E\u547D\u540D\u7A7A\u95F4\u4E2D\u3002",Ye=" \u5E94\u7528\u540D\u79F0\u662F\u5FC5\u9700\u7684\u3002",je=" \u5E94\u7528\u7A0B\u5E8F\u540D\u79F0\u5FC5\u987B\u4EE5\u5C0F\u5199\u5B57\u6BCD\u5F00\u5934\uFF0C\u4E14\u53EA\u5305\u542B\u5C0F\u5199\u5B57\u6BCD\uFF0C\u6570\u5B57\u548C\u5355\u8BCD\u4E4B\u95F4\u7684\u201C-\u201D\u3002",Be=" \u5BB9\u5668\u955C\u50CF\u662F\u5FC5\u987B\u7684 ",Ke=" \u5BB9\u5668\u955C\u50CF\u65E0\u6548: " + "\ufffd0\ufffd" + "",Ue=" pod \u7684\u6570\u91CF\u662F\u5FC5\u586B\u9879 ",We=" pod \u7684\u6570\u91CF\u5FC5\u987B\u662F\u6574\u6570 ",He=" \u8BBE\u7F6E\u5927\u91CF pod \u53EF\u80FD\u4F1A\u5BFC\u81F4\u96C6\u7FA4\u548C Dashboard UI \u51FA\u73B0\u6027\u80FD\u95EE\u9898\u3002",Je=" CPU \u4E0B\u9650\u5FC5\u987B\u662F\u6B63\u6574\u6570\u3002",Qe=" CPU \u4E0B\u9650\u5FC5\u987B\u662F\u6709\u6548\u7684\u6570\u5B57\u3002",Ze=" \u5185\u5B58\u4E0B\u9650\u5FC5\u987B\u662F\u6B63\u6574\u6570\u3002",et=" \u5185\u5B58\u4E0B\u9650\u5FC5\u987B\u662F\u4E00\u4E2A\u6709\u6548\u7684\u6570\u5B57\u3002",[["novalidate","",3,"formGroup"],["matInput","","formControlName","name","placeholder",o,"kdUniqueName","","required","",3,"maxlength","namespace"],["mode","indeterminate",1,"kd-deploy-form-progress",3,"ngClass"],["align","end"],[4,"ngIf"],t,["href","https://kubernetes.io/docs/user-guide/labels/","target","_blank","tabindex","-1"],r,[1,"material-icons"],["matInput","","formControlName","containerImage","placeholder",a,"kdValidImageReference","","required",""],_,["href","https://kubernetes.io/docs/user-guide/images/","target","_blank","tabindex","-1"],s,["matInput","","type","number","formControlName","replicas","placeholder",c,"min","1","kdWarnThreshold","100","required",""],d,["href","https://kubernetes.io/docs/concepts/workloads/controllers/deployment/","target","_blank","tabindex","-1"],p,["fxLayout","column"],["formControlName","portMappings",3,"protocols","isExternal","changeExternal"],R,["href","https://kubernetes.io/docs/user-guide/services/","target","_blank","tabindex","-1"],T,["formControlName","namespace","placeholder",f,"required","",3,"click"],[3,"value",4,"ngFor","ngForOf"],[3,"click"],S,A,["href","https://kubernetes.io/docs/admin/namespaces/","target","_blank","tabindex","-1"],E,[3,"hidden"],["formControlName","description","matInput","","placeholder",Te],ge,[1,"kd-margin-bottom"],Ce,["formControlName","labels",3,"labelArr"],Me,Ne,["formControlName","imagePullSecret","placeholder",Fe,3,"click"],Oe,fe,["href","https://kubernetes.io/docs/user-guide/secrets/","target","_blank","tabindex","-1"],Se,["fxLayout","row"],["fxFlex","auto"],["matInput","","type","number","placeholder",Ae,"name","cpuRequirement","min","0","formControlName","cpuRequirement"],["fxFlex","5"],["matInput","","type","number","placeholder",Pe,"name","memoryRequirement","min","0","formControlName","memoryRequirement"],he,["href","https://kubernetes.io/docs/admin/limitrange/","target","_blank","tabindex","-1"],Ie,[1,"kd-block"],["matInput","","placeholder",$e,"formControlName","containerCommand"],["matInput","","placeholder",ve,"formControlName","containerCommandArgs"],ye,["href","https://kubernetes.io/docs/user-guide/containers/","target","_blank","tabindex","-1"],De,["color","primary","formControlName","runAsPrivileged"],Le,be,["href","https://kubernetes.io/docs/concepts/workloads/pods/#privileged-mode-for-containers","target","_blank","tabindex","-1"],Ge,["formControlName","variables"],xe,["href","https://kubernetes.io/docs/tasks/inject-data-application/define-environment-variable-container/","target","_blank","tabindex","-1"],Xe,["type","button","color","primary","mat-raised-button","",3,"disabled","click"],ke,["type","button","color","primary","mat-button","",3,"disabled","click"],Ve,["type","button","color","primary","mat-button","",3,"click"],we,["mat-button","","color","primary",3,"hidden","click"],ze,qe,Ye,je,Be,Ke,Ue,We,He,[3,"value"],Je,Qe,Ze,et]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"form",0)(1,"kd-help-section")(2,"mat-form-field"),e.\u0275\u0275element(3,"input",1)(4,"mat-progress-bar",2),e.\u0275\u0275elementStart(5,"mat-hint",3),e.\u0275\u0275text(6),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(7,cn,2,0,"mat-error",4),e.\u0275\u0275template(8,dn,2,0,"mat-error",4),e.\u0275\u0275template(9,En,2,0,"mat-error",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(10,"kd-user-help"),e.\u0275\u0275elementContainerStart(11),e.\u0275\u0275i18n(12,5),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(13,"a",6),e.\u0275\u0275i18nStart(14,7),e.\u0275\u0275element(15,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(16,"kd-help-section")(17,"mat-form-field"),e.\u0275\u0275element(18,"input",9),e.\u0275\u0275template(19,un,2,0,"mat-error",4),e.\u0275\u0275template(20,pn,2,1,"mat-error",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(21,"kd-user-help"),e.\u0275\u0275elementContainerStart(22),e.\u0275\u0275i18n(23,10),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(24,"a",11),e.\u0275\u0275i18nStart(25,12),e.\u0275\u0275element(26,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(27,"kd-help-section")(28,"mat-form-field"),e.\u0275\u0275element(29,"input",13),e.\u0275\u0275template(30,Rn,2,0,"mat-error",4),e.\u0275\u0275template(31,Tn,2,0,"mat-error",4),e.\u0275\u0275template(32,gn,2,0,"mat-error",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(33,"kd-user-help"),e.\u0275\u0275elementContainerStart(34),e.\u0275\u0275i18n(35,14),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(36,"a",15),e.\u0275\u0275i18nStart(37,16),e.\u0275\u0275element(38,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(39,"kd-help-section")(40,"div",17)(41,"kd-port-mappings",18),e.\u0275\u0275listener("changeExternal",function(_){return r.changeExternal(_)}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(42,"kd-user-help"),e.\u0275\u0275elementContainerStart(43),e.\u0275\u0275i18n(44,19),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(45,"a",20),e.\u0275\u0275i18nStart(46,21),e.\u0275\u0275element(47,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(48,"kd-help-section")(49,"mat-form-field")(50,"mat-select",22),e.\u0275\u0275listener("click",function(){return r.resetImagePullSecret()}),e.\u0275\u0275template(51,Cn,2,2,"mat-option",23),e.\u0275\u0275elementStart(52,"mat-option",24),e.\u0275\u0275listener("click",function(){return r.handleNamespaceDialog()}),e.\u0275\u0275i18n(53,25),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(54,"kd-user-help"),e.\u0275\u0275elementContainerStart(55),e.\u0275\u0275i18n(56,26),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(57,"a",27),e.\u0275\u0275i18nStart(58,28),e.\u0275\u0275element(59,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(60,"div",29)(61,"kd-help-section")(62,"mat-form-field"),e.\u0275\u0275element(63,"textarea",30),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(64,"kd-user-help"),e.\u0275\u0275i18n(65,31),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(66,"kd-help-section")(67,"div",17)(68,"div",32),e.\u0275\u0275i18n(69,33),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(70,"kd-deploy-label",34),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(71,"kd-user-help"),e.\u0275\u0275elementContainerStart(72),e.\u0275\u0275i18n(73,35),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(74,"a",6),e.\u0275\u0275i18nStart(75,36),e.\u0275\u0275element(76,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(77,"kd-help-section")(78,"mat-form-field")(79,"mat-select",37),e.\u0275\u0275listener("click",function(){return r.getSecrets()}),e.\u0275\u0275template(80,Mn,2,2,"mat-option",23),e.\u0275\u0275elementStart(81,"mat-option",24),e.\u0275\u0275listener("click",function(){return r.handleCreateSecretDialog()}),e.\u0275\u0275i18n(82,38),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(83,"kd-user-help"),e.\u0275\u0275elementContainerStart(84),e.\u0275\u0275i18n(85,39),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(86,"a",40),e.\u0275\u0275i18nStart(87,41),e.\u0275\u0275element(88,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(89,"kd-help-section")(90,"div",42)(91,"mat-form-field",43),e.\u0275\u0275element(92,"input",44),e.\u0275\u0275template(93,Nn,2,0,"mat-error",4),e.\u0275\u0275template(94,Fn,2,0,"mat-error",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(95,"div",45),e.\u0275\u0275elementStart(96,"mat-form-field",43),e.\u0275\u0275element(97,"input",46),e.\u0275\u0275template(98,On,2,0,"mat-error",4),e.\u0275\u0275template(99,fn,2,0,"mat-error",4),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(100,"kd-user-help"),e.\u0275\u0275elementContainerStart(101),e.\u0275\u0275i18n(102,47),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(103,"a",48),e.\u0275\u0275i18nStart(104,49),e.\u0275\u0275element(105,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(106,"kd-help-section")(107,"div")(108,"mat-form-field",50),e.\u0275\u0275element(109,"input",51),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(110,"mat-form-field",50),e.\u0275\u0275element(111,"input",52),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(112,"kd-user-help"),e.\u0275\u0275elementContainerStart(113),e.\u0275\u0275i18n(114,53),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(115,"a",54),e.\u0275\u0275i18nStart(116,55),e.\u0275\u0275element(117,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(118,"kd-help-section")(119,"div",50)(120,"mat-checkbox",56),e.\u0275\u0275i18n(121,57),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(122,"kd-user-help"),e.\u0275\u0275elementContainerStart(123),e.\u0275\u0275i18n(124,58),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(125,"a",59),e.\u0275\u0275i18nStart(126,60),e.\u0275\u0275element(127,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(128,"kd-help-section"),e.\u0275\u0275element(129,"kd-environment-variables",61),e.\u0275\u0275elementStart(130,"kd-user-help"),e.\u0275\u0275elementContainerStart(131),e.\u0275\u0275i18n(132,62),e.\u0275\u0275elementContainerEnd(),e.\u0275\u0275elementStart(133,"a",63),e.\u0275\u0275i18nStart(134,64),e.\u0275\u0275element(135,"i",8),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementStart(136,"button",65),e.\u0275\u0275listener("click",function(){return r.deploy()}),e.\u0275\u0275i18n(137,66),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(138,"button",67),e.\u0275\u0275listener("click",function(){return r.preview()}),e.\u0275\u0275i18n(139,68),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(140,"button",69),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275i18n(141,70),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(142,"button",71),e.\u0275\u0275listener("click",function(){return r.switchMoreOptions()}),e.\u0275\u0275i18n(143,72),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275property("formGroup",r.form),e.\u0275\u0275advance(3),e.\u0275\u0275property("maxlength",r.nameMaxLength)("namespace",r.namespace.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngClass",e.\u0275\u0275pureFunction1(28,Sn,r.name.pending)),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",null==r.name.value?null:r.name.value.length," / ",r.nameMaxLength,""),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.name.errors?null:r.name.errors.uniqueName),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.name.errors?null:r.name.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.name.errors?null:r.name.errors.namePattern),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",null==r.containerImage.errors?null:r.containerImage.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.containerImage.errors?null:r.containerImage.errors.validImageReference),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngIf",null==r.replicas.errors?null:r.replicas.errors.required),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.replicas.errors?null:r.replicas.errors.kdValidInteger),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.replicas.errors?null:r.replicas.errors.warnThreshold),e.\u0275\u0275advance(9),e.\u0275\u0275property("protocols",r.protocols)("isExternal",r.isExternal),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngForOf",r.namespaces),e.\u0275\u0275advance(9),e.\u0275\u0275property("hidden",!r.isMoreOptionsEnabled()),e.\u0275\u0275advance(10),e.\u0275\u0275property("labelArr",r.labelArr),e.\u0275\u0275advance(10),e.\u0275\u0275property("ngForOf",r.secrets),e.\u0275\u0275advance(13),e.\u0275\u0275property("ngIf",null==r.cpuRequirement.errors?null:r.cpuRequirement.errors.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.cpuRequirement.errors?null:r.cpuRequirement.errors.kdValidInteger),e.\u0275\u0275advance(4),e.\u0275\u0275property("ngIf",null==r.memoryRequirement.errors?null:r.memoryRequirement.errors.min),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",null==r.memoryRequirement.errors?null:r.memoryRequirement.errors.kdValidInteger),e.\u0275\u0275advance(37),e.\u0275\u0275property("disabled",r.isCreateDisabled()),e.\u0275\u0275advance(2),e.\u0275\u0275property("disabled",r.isCreateDisabled()),e.\u0275\u0275advance(4),e.\u0275\u0275property("hidden",!r.isMoreOptionsEnabled()),e.\u0275\u0275advance(1),e.\u0275\u0275i18nExp(r.isMoreOptionsEnabled()),e.\u0275\u0275i18nApply(143))},directives:[i.\u0275NgNoValidate,i.NgControlStatusGroup,i.FormGroupDirective,q,g.KE,h.Nt,i.DefaultValueAccessor,i.NgControlStatus,i.FormControlName,Tt,i.RequiredValidator,i.MaxLengthValidator,se.pW,C.NgClass,me.oO,g.bx,C.NgIf,g.TO,Y,St,i.NumberValueAccessor,i.MinValidator,At,O.xw,Ut,de.gD,C.NgForOf,Ee.ey,on,O.yH,an.oG,mn,F.lW],styles:[".kd-block[_ngcontent-%COMP%]{display:block}.kd-deploy-input-row[_ngcontent-%COMP%]{margin-bottom:8px;margin-top:8px}  mat-progress-bar.kd-deploy-form-progress{clear:left;height:.5px;margin-bottom:-.5px;overflow:hidden;top:5px}  mat-progress-bar.kd-deploy-form-progress:not(.kd-deploy-form-progress-show){visibility:hidden}"]}),n})();function Pn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,10),e.\u0275\u0275elementEnd())}function hn(n,o){1&n&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275i18n(1,11),e.\u0275\u0275elementEnd())}let pe=(()=>{class n extends D{constructor(t,r,a,_){super(),this.namespace_=t,this.create_=r,this.history_=a,this.router_=_,this.inputData="",this.created_=!1}isCreateDisabled(){return!this.inputData||0===this.inputData.length}create(){this.create_.createContent(this.inputData).then(()=>{this.created_=!0,this.router_.navigate(["overview"],{queryParams:{[w.x]:this.namespace_.current()}})})}cancel(){this.history_.goToPreviousState("overview")}areMultipleNamespacesSelected(){return this.namespace_.areMultipleNamespacesSelected()}canDeactivate(){return this.isCreateDisabled()||this.created_}}return n.\u0275fac=function(t){return new(t||n)(e.\u0275\u0275directiveInject($.L),e.\u0275\u0275directiveInject(v),e.\u0275\u0275directiveInject(z.q),e.\u0275\u0275directiveInject(P.Router))},n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create-from-input"]],features:[e.\u0275\u0275InheritDefinitionFeature],decls:11,vars:4,consts:function(){let o,t,r,a,_;return o=" \u4E86\u89E3\u66F4\u591A " + "\ufffd#5\ufffd" + "open_in_new" + "\ufffd/#5\ufffd" + "",t=" \u4E0A\u4F20 ",r="Cancel",a=" \u8F93\u5165 YAML \u6216 JSON \u5185\u5BB9\uFF0C\u6307\u5B9A\u8981\u4E3A\u6587\u4EF6\u4E2D\u6307\u5B9A\u7684\u547D\u540D\u7A7A\u95F4\u521B\u5EFA\u7684\u8D44\u6E90\u3002",_=" \u8F93\u5165 YAML \u6216 JSON \u5185\u5BB9\uFF0C\u6307\u5B9A\u8981\u4E3A\u5F53\u524D\u9009\u5B9A\u7684\u547D\u540D\u7A7A\u95F4\u521B\u5EFA\u7684\u8D44\u6E90\u3002",[[1,"kd-create-from-input-info"],[4,"ngIf"],["href","https://kubernetes.io/docs/tasks/run-application/run-stateless-application-deployment/","target","_blank"],o,[1,"material-icons"],[3,"text","textChange"],["type","button","color","primary","mat-raised-button","",3,"disabled","click"],t,["type","button","color","primary","mat-button","",3,"click"],r,a,_]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Pn,2,0,"span",1),e.\u0275\u0275template(2,hn,2,0,"span",1),e.\u0275\u0275elementStart(3,"a",2),e.\u0275\u0275i18nStart(4,3),e.\u0275\u0275element(5,"i",4),e.\u0275\u0275i18nEnd(),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"kd-text-input",5),e.\u0275\u0275listener("textChange",function(_){return r.inputData=_}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"button",6),e.\u0275\u0275listener("click",function(){return r.create()}),e.\u0275\u0275i18n(8,7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(9,"button",8),e.\u0275\u0275listener("click",function(){return r.cancel()}),e.\u0275\u0275i18n(10,9),e.\u0275\u0275elementEnd()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",r.areMultipleNamespacesSelected()),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!r.areMultipleNamespacesSelected()),e.\u0275\u0275advance(4),e.\u0275\u0275property("text",r.inputData),e.\u0275\u0275advance(1),e.\u0275\u0275property("disabled",r.isCreateDisabled()))},directives:[C.NgIf,I.t,F.lW],styles:[".kd-create-from-input-info[_ngcontent-%COMP%]{margin-bottom:24px;padding:0 4px}.kd-create-from-input-info[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:14px}.kd-create-from-input-button[_ngcontent-%COMP%]{margin-left:0}  .kd-ace{margin-bottom:24px}"]}),n})();var In=m(3546),Re=m(3848);const $n={path:"",component:(()=>{class n extends D{canDeactivate(){return this.fromInput.canDeactivate()&&this.fromFile.canDeactivate()&&this.fromForm.canDeactivate()}}return n.\u0275fac=function(){let o;return function(r){return(o||(o=e.\u0275\u0275getInheritedFactory(n)))(r||n)}}(),n.\u0275cmp=e.\u0275\u0275defineComponent({type:n,selectors:[["kd-create"]],viewQuery:function(t,r){if(1&t&&(e.\u0275\u0275viewQuery(pe,5),e.\u0275\u0275viewQuery(te,5),e.\u0275\u0275viewQuery(ue,5)),2&t){let a;e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.fromInput=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.fromFile=a.first),e.\u0275\u0275queryRefresh(a=e.\u0275\u0275loadQuery())&&(r.fromForm=a.first)}},features:[e.\u0275\u0275InheritDefinitionFeature],decls:8,vars:1,consts:function(){let o,t,r;return o="\u8F93\u5165\u5E76\u521B\u5EFA",t="\u4ECE\u6587\u4EF6\u521B\u5EFA",r="\u4ECE\u8868\u5355\u521B\u5EFA",[[1,"kd-create-container"],["label",o],["label",t],["label",r]]},template:function(t,r){1&t&&(e.\u0275\u0275elementStart(0,"mat-card",0)(1,"mat-tab-group")(2,"mat-tab",1),e.\u0275\u0275element(3,"kd-create-from-input"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"mat-tab",2),e.\u0275\u0275element(5,"kd-create-from-file"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"mat-tab",3),e.\u0275\u0275element(7,"kd-create-from-form"),e.\u0275\u0275elementEnd()()()),2&t&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("@.disabled",!0))},directives:[In.a8,Re.SP,Re.uX,pe,te,ue],styles:[".kd-create-container[_ngcontent-%COMP%]{padding:0}.kd-create-container[_ngcontent-%COMP%]     .mat-tab-body-content{height:auto;padding:20px}"]}),n})(),data:{breadcrumb:ot.SX.Create},canDeactivate:[Z]};let vn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({imports:[[P.RouterModule.forChild([$n])],P.RouterModule]}),n})(),yn=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.\u0275\u0275defineNgModule({type:n}),n.\u0275inj=e.\u0275\u0275defineInjector({providers:[Z],imports:[[ee.m,H.K,rt,tt,vn]]}),n})()}}]);